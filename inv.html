<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warehouse Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- D3.js library for charts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        #main-nav {
            width: 100%;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            padding: 0 40px;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            box-sizing: border-box;
            flex-shrink: 0;
        }
        #main-nav a {
            padding: 18px 20px;
            text-decoration: none;
            color: #495057;
            font-weight: 600;
            font-size: 15px;
            border-bottom: 3px solid transparent;
            transition: color 0.2s, border-bottom-color 0.2s;
            cursor: pointer;
        }
        #main-nav a:hover {
            color: #007bff;
        }
        #main-nav a.active {
            color: #007bff;
            border-bottom-color: #007bff;
        }
        #content-area {
            padding: 24px;
            flex-grow: 1;
            overflow-y: auto;
        }
        .loading-text {
            text-align: center;
            font-size: 1.5rem;
            color: #888;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <nav id="main-nav">
        <a data-page="overview.html">Overview</a>
        <a data-page="obpick.html">Outbound Pick</a>
        <a data-page="put.html">Putaway</a>
        <a data-page="inv.html" class="active">Inventory Accuracy</a>
    </nav>

    <main id="content-area">
        <!-- Content from other pages will be loaded here -->
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('#main-nav a');
            const contentArea = document.getElementById('content-area');
            const initialPage = document.querySelector('#main-nav a.active').getAttribute('data-page');

            // --- Function to load and execute scripts ---
            // We need to re-create script tags for them to be executed by the browser when added to the DOM.
            const executeScripts = (containerElement) => {
                const scripts = containerElement.querySelectorAll('script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement('script');
                    // Copy attributes (like src, type)
                    Array.from(oldScript.attributes).forEach(attr => {
                        newScript.setAttribute(attr.name, attr.value);
                    });
                    // Copy inline script content
                    if (oldScript.innerHTML) {
                        newScript.innerHTML = oldScript.innerHTML;
                    }
                    // Append the new script to the head to execute it
                    document.head.appendChild(newScript);
                    // Clean up by removing the script after appending
                    document.head.removeChild(newScript);
                });
            };
            
            // --- Function to fetch and display content ---
            async function loadContent(page) {
                // Show loading state
                contentArea.innerHTML = '<h2 class="loading-text">Loading...</h2>';
                try {
                    const response = await fetch(page);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const html = await response.text();
                    
                    contentArea.innerHTML = html;
                    executeScripts(contentArea);

                } catch (error) {
                    console.error('Failed to load page:', error);
                    contentArea.innerHTML = `<h2>Error loading page: ${page}</h2><p>${error.message}</p><p>Please make sure you are running this from a local web server.</p>`;
                }
            }

            // --- Event listeners for navigation links ---
            navLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    
                    const currentActive = document.querySelector('#main-nav a.active');
                    if(currentActive) {
                        currentActive.classList.remove('active');
                    }
                    
                    link.classList.add('active');
                    
                    const pageToLoad = link.getAttribute('data-page');
                    loadContent(pageToLoad);
                });
            });

            // --- Load the default page when the website opens ---
            if (initialPage) {
                loadContent(initialPage);
            }
        });
    </script>
</body>
</html>
